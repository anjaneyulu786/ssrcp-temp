<!DOCTYPE html>
<html>
<head>
 
   <!-- Custom fonts for this template-->
   <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">

   <!-- Page level plugin CSS-->
   <link href="vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet">

   <!-- Custom styles for this template-->
   <link href="css/sb-admin.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Custom fonts for this template-->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <!-- Page level plugin CSS-->
  <link href="vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet">
  <!-- Custom styles for this template-->
  <link href="css/sb-admin.css" rel="stylesheet">
  <style>    
    #customers {
      font-family: Arial, Helvetica, sans-serif; border-collapse: collapse; width: 100%;
    }
    #customers td, #customers th {
      border: 1px solid #ddd;
      padding: 8px;
    }
    #customers tr:nth-child(even){background-color: #f2f2f2;}
    #customers tr:hover {background-color: #ddd;}
    #customers th {
      padding-top: 12px; padding-bottom: 12px; text-align: left; background-color: #4CAF50; color: white;
    }

    #img-upload{
        width: 100%;
    }

    input[type="file"] {
      display: block;
    }
    .imageThumb {
      max-height: 75px;
      border: 2px solid;
      padding: 1px;
      cursor: pointer;
    }
    .pip {
      display: inline-block;
      margin: 10px 10px 0 0;
    }
    .remove {
      display: block;
      background: #444;
      border: 1px solid black;
      color: white;
      text-align: center;
      cursor: pointer;
    }
    .remove:hover {
      background: white;
      color: black;
    }
</style>
</head>
<body style="overflow: hidden;">
    <nav class="navbar navbar-expand navbar-dark bg-dark static-top navbar-fixed-top">
      <a class="navbar-brand mr-1" href="login.html">SSRCP </a>
        <button class="btn btn-link btn-sm text-white order-1 order-sm-0" id="sidebarToggle" href="#">
          <i class="fas fa-bars"></i>
       </button>
                <!-- NAVBAR -->
       <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
         <ul class="navbar-nav ml-auto ml-md-0">
           <li class="nav-item ">
              <button type="button" class="btn btn-info btn-lg, btn pull-right" data-toggle="modal" data-target="#productionLog">Production Log</button> 
           </li>
            <li class="nav-item dropdown no-arrow">
              <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"    aria-expanded="false">
                <i class="fas fa-user-circle fa-fw"></i>
              </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                <a class="dropdown-item" href="#">Settings</a>
                <a class="dropdown-item" href="#">Activity Log</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#" >Logout</a>
              </div>
            </li>
          </ul>
       </form>
    </nav>
                <!-- SIDENAV -->
    <div id="wrapper">
      <ul class="sidebar navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="/home">
              <i class="fas fa-fw fa-tachometer-alt"></i>
              <span>Dashboard</span>
            </a>
          </li> 
          
          <li class="nav-item active">
            <a class="nav-link" href="/models">
            <i class="fa fa-list-alt" aria-hidden="true"></i>
            <span>Tile Models</span>
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="/productionLog">
              <i class="fa fa-list-alt" aria-hidden="true"></i>
              <span>ProductionLog</span></a>
          </li>        
        <li class="nav-item">
            <a class="nav-link" href="#">
            <i class="fas fa-fw fa-table"></i>
            <span>Enquiries</span></a>
         </li>
         <li class="nav-item">
            <a class="nav-link" href="#">
            <i class="fas fa-fw fa-table"></i>
            <span>Sales</span></a>
         </li> 
        </ul>
  <div id="content-wrapper">
    <div class="container-fluid"> 
              <!-- DataTables Example -->
      <div class="card mb-3">    
        <body>
          <div class="card-body">
            <form class="d-none d-md-inline-block form-inline ml-auto mr-0 mr-md-3 my-2 my-md-0">
              <ul class="navbar-nav ml-auto ml-md-0">
                  <li class="nav-item dropdown no-arrow">
                    <a class="btn btn-primary btn-block" href="#" data-toggle="modal" data-target="#addTilesModal">Add Tiles Models</a>
                  </li>
              </ul>
            </form>
          <div class="table-responsive">
            <table class="table table-bordered" id="tileModeldataTable" width="100% " length="100%" cellspacing="0">
                <thead>
                <tr>
                  <th>ModelName</th>
                  <th>Colors</th>
                  <th>ModelNumber</th>
                  <th>Quantity</th>
                  <th>Availability</th>
                  <th>Action</th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>
    </div>
                  <!-- Sticky Footer -->
       <footer class="sticky-footer" style="height: 12%; position: absolute ;">
        <div class="container my-auto">
          <div class="copyright text-center my-auto">
            <span> Your's SSRCP 2020</span>
          </div>
        </div>
       </footer>
      </div>
     </div>
    </div>
               <!-- ADD TILE MODELPAGE -->
    <div class="modal fade" id="addTilesModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Add Tile Model</h5>
              <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <div id="tileModelSuccessMess" class="alert alert-success" style="display: none;">
                  <strong>Success!</strong> Tile Model Added Successfully.
                </div>   
                <div id="tileModelErrorMess" class="alert alert-danger" style="display: none;">
                  <strong>Error!</strong> Please provide valid details.
                </div>
              </div>
            <div class="form-group">
            <div class="form-label-group">
              <input type="text" id="modelName" class="form-control" placeholder="Model Name" required="required" autofocus="autofocus"class="form-control form-control-sm">
              <label for="modelName">ModelName</label>
            </div>
            </div>
          <div class="form-group">
            <div class="form-label-group">
              <input type="text" id="color" class="form-control" placeholder="Color" autofocus="autofocus">
              <label for="color">Color</label>
            </div>
          </div>
            <div class="form-group">
            <div class="form-label-group">
              <input type="text" id="modelNumber" class="form-control" placeholder="modelCode" autofocus="autofocus">
              <label for="modelNumber">ModelCode</label>
            </div>
          </div>
          <div class="form-group">
            <div class="form-label-group">
              <input type="number" id="quantity" class="form-control" placeholder="quantity" required="required" autofocus="autofocus">
              <label for="quantity">quantity</label>
            </div>
          </div>
          <div class="form-group">
            <div class="form-label-group">
              <select id="isAvailable" class="form-control" placeholder="isAvailable" required="required" autofocus="autofocus">
                <option>Availability</option>
                <option value="true">True</option>
              <option value="false">False</option>
              </select>
            </div>
          </div>
          <div class="form-group" id="tilesUpload">
            <div class="form-label-group">
              <input type="file" id="tileFile" class="form-control" placeholder="image" required="required">
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
              <button class="btn btn-success" onclick="addTile()">Create</button>
          </div>
        </div> 
      </div>
    </div>
    </div>
                <!-- Edit tile modal page  -->

  <div class="modal fade" id="editTilesModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Update Tile Model</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <div id="editTileModelSuccessMess" class="alert alert-success" style="display: none;">
                <strong>Success!</strong> Tile Model Updated Successfully.
              </div>   
              <div id="editTileModelErrorMess" class="alert alert-danger" style="display: none;">
                <strong>Error!</strong> Please provide valid details.
              </div>
            </div>
          <div class="form-group">
          <div class="form-label-group">
            <input type="hidden" id="editTileId" >
            <input type="text" id="editModelName" class="form-control" placeholder="Model Name" required="required" autofocus="autofocus"class="form-control form-control-sm">
            <label for="modelName">ModelName</label>
          </div>
          </div>
        <div class="form-group">
          <div class="form-label-group">
            <input type="text" id="editColor" class="form-control" placeholder="Color" autofocus="autofocus">
            <label for="color">Color</label>
          </div>
        </div>
          <div class="form-group">
          <div class="form-label-group">
            <input type="text" id="editModelNumber" class="form-control" placeholder="modelCode" autofocus="autofocus">
            <label for="modelNumber">ModelCode</label>
          </div>
        </div>
        <div class="form-group">
          <div class="form-label-group">
            <input type="number" id="editQuantity" class="form-control" placeholder="quantity" required="required" autofocus="autofocus">
            <label for="quantity">quantity</label>
          </div>
        </div>
        <div class="form-group">
          <div class="form-label-group">
            <select id="editIsAvailable" class="form-control" placeholder="isAvailable" required="required" autofocus="autofocus">
              <option value="">Availability</option>
              <option value="true">True</option>
            <option value="false">False</option>
            </select>
          </div>
        </div>
        <div class="form-group" id="editTilesUpload">
          <div class="form-label-group">
            <input type="file" id="editImageFile" class="form-control" placeholder="image" required="required">
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <p button class="btn btn-success" onclick  id="updateTileModel()">Update</button></p>
          <p id="demo"></p>
        </div>
      </div> 
    </div>
  </div>
  </div>
                <!-- MODAL PAGE   -->
   <div class="modal fade" id="productionLog" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">            
          <h5 class="modal-title" id="exampleModalLabel">Add Production</h5>
          <button type="button" class="close" data-dismiss="modal"aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="hidden-div">
           <div class="modal-body">
               <h6>Choose Material</h6>
               <div class="modal-body">
                  <div class="form-group">
                    <div id="tileModelSuccessMess" class="alert alert-success" style="display: none;">
                      <strong>Success!</strong> Tile Model Added Successfully.
                    </div>   
                    <div id="tileModelErrorMess" class="alert alert-danger" style="display: none;">
                      <strong>Error!</strong> Please provide valid details.
                    </div>
                  </div>
                   <h6>tileModel</h6>
                      <div class="modal-body">      
                        <div class="dropdown">
                              <select class="form-control" id="tileModels" > 
                            </select>
                          </div>
                      </div>
                      <h6>Comments</h6>
                  <div class="form-group">
                    <div class="form-label-group">
                      <input type="text" id="comment" class="form-control" placeholder="Comments" class="btn btn-default" autofocus="autofocus">
                    </div>
                  </div>
                  <h6>QUANTITY</h6>
                  <div class="form-group">
                    <div class="form-label-group">
                      <input type="number" id="quantity" class="form-control" required="required"placeholder="Quantity"  autofocus="autofocus"> 
                    </div>
                  </div>
                  <h6>DateCreated</h6>
                    <div class="form-group">
                    <div class="form-label-group">
                      <input type="textarea" id="dateCreated" class="form-control" placeholder="DateCreated" autofocus="autofocus">
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button> 
                  <input type="Submit" id="sendData" onclick="addProductionLog()" class="btn btn-success" data-dismiss="modal" value="Submit">
                 </div> 
            </div> 
          </div>
       </div>
     </div>
   </div> 
  </div>
                <!-- Bootstrap core JavaScript-->
                <script src="vendor/jquery/jquery.min.js"></script>
                <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

                <!-- Core plugin JavaScript-->
                <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

                <!-- Page level plugin JavaScript-->
                <script src="vendor/datatables/jquery.dataTables.js"></script>
                <script src="vendor/datatables/dataTables.bootstrap4.js"></script>

                <!-- Custom scripts for all pages-->
                <script src="js/sb-admin.min.js"></script>

                <!-- Demo scripts for this page-->
                <script src="js/demo/datatables-demo.js"></script>
                <script src="js/tileModels.js"></script>
                <script src="../js/reqHandler.js"></script>
                <!--    creating a post   -->
<script>
   function updateTileModel() {
          document.getElementById("demo").innerHTML = Boolean(true>false);
        }
  var reqHandler = new ReqHandler();
  function addTile(){ 
    var tilesObj = {
      "tileModelName": $("#modelName").val(),
      "color": $("#color").val(),
      "modelNumber": $("#modelNumber").val(),
      "quantity": $("#quantity").val(),
      "tileModels": $("#isAvailable").val(),
      "modelImage": imageBase64String
    };
    $.post({url: '/tileModel', data: tilesObj }, function (resp) {
      if(resp.status == 'Success'){
        $("#tileModelSuccessMess").css("display", "block");
        setTimeout(function(){ 
          $("#tileModelSuccessMess").css("display", "none"); 
          $("#addTilesModal").modal('hide');
          getTilesList();
        }, 3000);
      }else{
        $("#tileModelErrorMess").css("display", "block");
        setTimeout(function(){ $("#tileModelErrorMess").css("display", "none"); }, 4000);
      }
    });
  } 
           // <<<<<<<<<<<<<<<<<<<<<<<<<{ creating a grid }>>>>>>>>>>>>>>>>>>>>>>>
  function getTilesList(){
    $.get({ url : '/tileModels'}, function(resp){ 
      if(resp.status == 'Success'){
        loadTileModelsGrid(resp.result);
      }else{
        alert(resp.status);
      }
    });
   }
   getTilesList();
   var imageBase64String = "", editImageBase64String = "";
    function uploadTileImage() {
      if (window.File && window.FileList && window.FileReader) {
        $("#tileFile").on("change", function(e) {
          var files = e.target.files;
            var f = files[0];
            var fileReader = new FileReader();
            fileReader.onload = (function(e) {
              var file = e.target;
              $('.pip').html('');
                $("<span  class=\"pip\"><img class=\"imageThumb\" src=\"" + file.result + "\" title=\"" + file.name + "\"/><span class=\"remove\" onclick='removeFile(\""+file.result+"\")'>&times;</span>" +
                "<br/></span>").insertAfter("#tilesUpload");
              $(".remove").click(function(e){
                $(this).parent(".pip").remove();
              });
              imageBase64String = file.result.split(",")[1];
            });
            fileReader.readAsDataURL(f);
        });

        $("#editImageFile").on("change", function(e) {
          var files = e.target.files, f = files[0];
            var fileReader = new FileReader();
            fileReader.onload = (function(e) {
              var file = e.target;
              $('.pip').html('');
                $("<span  class=\"pip\"><img class=\"imageThumb\" src=\"" + file.result + "\" title=\"" + file.name + "\"/><span id= \"removeEditTile\" class=\"remove\" onclick='removeFile(\""+file.result+"\")'>&times;</span>" +
                "<br/></span>").insertAfter("#editTilesUpload");
              $("#removeEditTile").click(function(e){
                $(this).parent(".pip").remove();
              });
              editImageBase64String = file.result.split(",")[1];
            });
            fileReader.readAsDataURL(f);
        });
      } else {
        alert("Error !",  "Your browser doesn't support to File API");
      }
    };

    function removeFile(file){
      var removeItem = file.split(",")[1];
      if(imageBase64String == removeItem){
        imageBase64String = "";
      }
    }

    uploadTileImage();

   function loadTileModelsGrid(result){
      var formattedTileModels = [];
        result.forEach(obj=>{
            var tempTileModelsObj = [];
            tempTileModelsObj.push('<span ><img style="height:50px;width:50px;" src="data:image/png;base64,'+obj.modelImage+'" </span>&nbsp;&nbsp;' + obj.tileModelName);
            tempTileModelsObj.push(obj.color);
            tempTileModelsObj.push(obj.modelNumber);
            tempTileModelsObj.push(obj.quantity);
            tempTileModelsObj.push(obj.isAvailable);
            tempTileModelsObj.push('<button class="btn btn-primary" href="#" data-toggle="modal" data-target="#editTilesModal" onclick="getTileModalById('+obj.tileModelId+')">Edit</button>');
            
            formattedTileModels.push(tempTileModelsObj);
        }); 
      

        // <<<<<<<<<<<<<<<<<<<<<data table>>>>>>>>>>>>>>>>>>>>>>>
        $('#tileModeldataTable').DataTable({
         data: formattedTileModels,
         columns: [
            { title: "ModelName" },
            { title: "Color" },
            { title: "ModelNumber" },
            { title: "Quantiity" },
            { title: "Availability" },
            { title: "Action"},
        ],
         bDestroy: true
       });
    }

<<<<<<< HEAD
    function getTileModalById(tileId){
      // console.log(tileId);
      $.get({ url : '/tileModel/'+tileId}, function(resp){ 
      if(resp.status == 'Success'){
        var tileObj = resp.result[0];
        $('#editModelName').val(tileObj.tileModelName);
        $('#editColor').val(tileObj.color);
        $('#editModelNumber').val(tileObj.modelNumber);
        $('#editQuantity').val(tileObj.quantity);
        $('#editIsAvailable').val(tileObj.isAvailable);
        $('.pip').html('');
        var imgSrc = "data:image/png;base64,"+tileObj.modelImage;
        $("<span  class='pip'><img class='imageThumb' src='"+imgSrc+"' title='Tile Image' /><span class='remove' onclick='removeEditFile('"+tileObj.modelImage+"')'>&times;</span>" +
        "<br/></span>").insertAfter("#editTilesUpload");
        console.log(resp);
      }else{
        alert(resp.status);
      }
    });
 }
    function removeEditFile(fileObj){
      var removeItem = file.split(",")[1];
      if(editImageBase64String == removeItem){
        editImageBase64String = "";
      }
    }
         // <!-- UPADATE-TILEMODEL-PAGE -->
     function updateTileModel(){ 
        var tilesObj = {
          "tileModelName": $("#editModelName").val(),
          "color": $("#editColor").val(),
          "modelNumber": $("#editModelNumber").val(),
          "quantity": $("#editQuantity").val(),
          "tileModels": $("#editIsAvailable").val(),
          "modelImage": editImageBase64String
        };
        $.put({url: '/tileModel/' }, function (resp) {
          if(resp.status == 'Success'){
            $("#editModelSuccessMess").css("display", "block");
            setTimeout(function(){ 
              $("#editTileModelSuccessMess").css("display", "none"); 
              $("#editTileModel").modal('hide');
              putTilesList();
            }, 3000);
          }else{
            $("#editModelErrorMess").css("display", "block");
            setTimeout(function(){ $("#editModelErrorMess").css("display", "none"); }, 4000);
          }
        });
     } 
      </script>
=======
 function getTileModalById(tileId){
    $.get({ url : '/tileModel/'+tileId}, function(resp){ 
    if(resp.status == 'Success'){
      var tileObj = resp.result[0];
      $('#editTileId').val(tileObj.tileModelId);
      $('#editModelName').val(tileObj.tileModelName);
      $('#editColor').val(tileObj.color);
      $('#editModelNumber').val(tileObj.modelNumber);
      $('#editQuantity').val(tileObj.quantity);
      $('#editIsAvailable').val(tileObj.isAvailable);
      $('.pip').html('');
      var imgSrc = "data:image/png;base64,"+tileObj.modelImage;
      $("<span  class=\"pip\"><img class=\"imageThumb\" src=\"" +imgSrc + "\" title=\"TestFile\"/><span id= \"removeEditTile\" class=\"remove\" onclick='removeEditFile(\""+tileObj.modelImage+"\")'>&times;</span>" +
                "<br/></span>").insertAfter("#editTilesUpload");
      $("#removeEditTile").click(function(e){
          $(this).parent(".pip").remove();
    });
    }else{
      alert(resp.status);
    }
  });
 }

function removeEditFile(fileObj){
  var removeItem = fileObj.split(",")[1];
  if(editImageBase64String == removeItem){
    editImageBase64String = "";
  }
}

 function updateTileModel(){ 
    var tileObj = {
      "tileModelId" : $("#editTileId").val(),
      "tileModelName": $("#editModelName").val(),
      "color": $("#editColor").val(),
      "modelNumber": $("#editModelNumber").val(),
      "quantity": $("#editQuantity").val(),
      "tileModels": $("#editIsAvailable").val(),
      "modelImage": editImageBase64String
    };

    console.log(tileObj);
    $.ajax({
      url: '/tileModel/',
      type: 'PUT',
      data : tileObj,
      success: function(response) {
        if(response.status == 'Success'){
          $("#editTileModelSuccessMess").css("display", "block");
          setTimeout(function(){ 
            $("#editTileModelSuccessMess").css("display", "none"); 
            $("#editTilesModal").modal('hide');
            getTilesList();
          }, 3000);
        }else{
          $("#editTileModelErrorMess").css("display", "block");
          setTimeout(function(){ $("#editTileModelErrorMess").css("display", "none"); }, 4000);
        }
      }
    });
    // reqHandler.put({url: '/tileModel/'}, function (resp) {
    //   if(resp.status == 'Success'){
    //     $("#editModelSuccessMess").css("display", "block");
    //     setTimeout(function(){ 
    //       $("#editTileModelSuccessMess").css("display", "none"); 
    //       $("#editTileModel").modal('hide');
    //       getTilesList();
    //     }, 3000);
    //   }else{
    //     $("#editModelErrorMess").css("display", "block");
    //     setTimeout(function(){ $("#editModelErrorMess").css("display", "none"); }, 4000);
    //   }
    // });
  } 
    </script>
>>>>>>> 9a9f087f2480c7bfb2132568b998b2d619d04c53
  </body>
</html>